<?php
$urlBack = empty($fromEmail)
    ? $this->url('forgot-password', array(), array('query' => array('ref' => $ref)))
    : $this->url('login/role', array('role' => $ref));
?>
<div class="container content-wrapper container-body">
    <div class="box-header"><?php echo $this->translate('MSG_LG_011_PasswordLabel'); ?></div>
    <div class="panel-body">
        <div class="row">
            <div class="title"></div>
            <div class="col-sm-12">
                <form class="form-horizontal" id="submit-form" method="post"
                      action="<?php echo $this->url('forgot-password/default', array('action' => 'update-password')); ?>">
                    <!--Error message content-->
                    <div class="form-group">
                        <div class="col-sm-12 col-xs-12 text-left flag-notice error-box" id="errors-list">
                            <?php if (!empty($errors)) { ?>
                                <ul>
                                    <?php foreach ($errors as $error) { ?>
                                        <li><h5><?php echo $error; ?></h5></li>
                                    <?php } ?>
                                </ul>
                            <?php } ?>
                        </div>
                    </div>
                    <input type="hidden" name="token" value="<?php echo empty($token) ? '' : $token ?>">
                    <div class="form-group">
                        <label for="lbUserId"
                               class="col-sm-4 col-xs-12 control-label"><?php echo $this->translate('MSG_LG_037_IdLabel'); ?></label>
                        <div class="col-sm-8 col-xs-12">
                            <?php echo $username; ?>
                        </div>
                        <input type="hidden" name="username" value="<?php echo $username ?>" />
                    </div>
                    <div class="form-group">
                        <label for="txtNewPassword"
                               class="col-sm-4 col-xs-12 control-label"><?php echo $this->translate('MSG_LG_038_NewPasswordLabel'); ?></label>
                        <div class="col-md-7 col-sm-8 col-xs-12">
                            <input type="password" class="form-control" id="txtNewPassword"
                                   name="newPassword"
                                   placeholder="<?php echo $this->translate('MSG_LG_038_NewPasswordLabel'); ?>" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="txtConfirmPassword"
                               class="col-sm-4 col-xs-12 control-label"><?php echo $this->translate('MSG_LG_039_ConfirmNewPasswordLabel'); ?></label>
                        <div class="col-md-7 col-sm-8 col-xs-12">
                            <input type="password" class="form-control" id="txtConfirmPassword"
                                   name="confirmPassword"
                                   placeholder="<?php echo $this->translate('MSG_LG_039_ConfirmNewPasswordLabel'); ?>" />
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-7 col-sm-8 col-xs-12 col-md-offset-4 col-sm-offset-4 col-xs-offset-0">
                            <input type="submit" name="btnSubmit" id="btnSubmit"
                                   class="col-md-5 col-sm-5 col-xs-12 btn btn-success btn-space pull-right"
                                   value="<?php echo $this->translate('MSG_AP_007_ConfirmLabel') ?>" />
                            </input>
                            <a id="btnBack" href="<?php echo $urlBack; ?>"
                               class="col-md-5 col-sm-5 col-xs-12 btn btn-default btn-space pull-left"><?php echo $this->translate('MSG_AP_005_BackLabel') ?>
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Success modal-->
<div class="modal fade dialog-position col-xs-12" id="confirm-success-dialog" role="dialog" data-keyboard="false"
     data-backdrop="static">
    <div class="modal-dialog modal-sm">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><?php echo $this->translate('MSG_LG_040_UpdatePassSuccessLabel') ?></h4>
            </div>
            <div class="modal-body text-left">
                <?php echo $this->translate('MSG_LG_041_UpdatePassSuccessMessage') ?>
            </div>
            <div class="modal-footer">
                <div class="col-sm-12 col-xs-12 text-right">
                    <a id="btnFinish" href="<?php echo $this->url('login/role', array('role' => $ref)); ?>"
                       class="btn btn-primary col-sm-5 col-xs-5 pull-right"><?php echo $this->translate('MSG_AP_004_FinishLabel'); ?>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Scripts-->
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/js/login/new-password.js"></script>

<script>
    $(document).ready(function () {
        NEW_PASSWORD.messageList = <?php echo json_encode($translator);?>;
        NEW_PASSWORD.init();
    });
</script>